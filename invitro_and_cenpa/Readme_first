### READ ME FIRST ###

#This readme file contains information on how to use the files in the invitro_and_cenpa subfolder. Files in this folder were used to generate subfigures in figure 2, figure 6 and associated supplementary figures in https://doi.org/10.1101/2021.07.06.451383 (and the associated manuscript on DiMeLo-seq)

### Description of files:

## Figure 2 (in vitro DiMeLo-seq):

# DiMeLoseq_in_vitro_fastq_to_length_filtered_bam.sh

#bash script for processing fastq output of Megalodon/Guppy to make length filtered bam files. (filtering out reads > 3.6 kb ==> reads containing the full 18x601 array sequence)

# DiMeLoseq_in_vitro_aggregate_analyses.py

#python script for (i) plotting histogram of mA/A for all reads and (ii) plotting mA/read for all positions along template. Uses length filtered bam as input.

# DiMeLoseq_in_vitro_individual_read_called_nucleosome_analyses.py

#python script for (i) smoothing and thresholding mA probability scores for each read, (ii) plotting heatmap of individual reads clustered by mA positions (Jaccard clustering), (iii) calling nucleosomes based on methylation protections or gaps, (iv) plotting statistics related to called nucleosomes such as offset from 601 dyad position and (v)methylation around the called nucleosome dyad axis.

## Figure 6 (in situ CENP-A DiMeLo-seq):

# DiMeLoseq_in_situ_CENPA_kmer_mA.ipynb

#Jupyter python notebook showing example script for plotting mA/A histogram for all libraries and subsets of reads in libraries (subset based on presence of CENP-A-enriched-kmer). Takes Guppy or Megalodon generated bam with modified base calls as input.

# DiMeLoseq_in_situ_CENPA_kmer_mA_plotting.ipynb

#Jupyter python notebook for plotting mA/A results from DiMeLoseq_in_situ_CENPA_kmer_mA.ipynb

# DiMeLoseq_in_situ_roi_single_molecule_v7_q10.py

#python script for extracting reference position adjusted mA probability arrays for reads that map to specific region of genome (specified in bed file) for a given library from Guppy+Winnowmap generated hybrid bam files. Outputs csv containing read ID and array of mA probability scores (or NaNs for non A's and non-covered regions of the region of interest) for reads that align within -windowsize to +windowsize around the midpoint of bed file.

# DiMeLoseq_in_situ_CENPA_aggregate_analyses_mA_A_nucleosome_density.py

#python script for plotting aggregate mA/A for a specified region of the genome from csv file generated by DiMeLoseq_in_situ_roi_single_molecule_v7_q10.py. Also used for binning methylation signal (probability of at least 1 mA within bin > threshold) to estimate nucleosome density over a rolling window for the given region of interest.

# DiMeLoseq_in_situ_CENPA_aggregate_analyses_mA_A_nucleosome_density.ipynb

#Jupyter python notebook showing example for plotting aggregate mA/A for a specified region of the genome from csv file generated by DiMeLoseq_in_situ_roi_single_molecule_v7_q10.py. Also used for binning methylation signal (probability of at least 1 mA within bin > threshold) to estimate nucleosome density over a rolling window for the given region of interest.
